<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Normalized Least-mean-fourth (NLMF) &#8212; Padasip 1.1.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Padasip 1.1.0 documentation" href="../../index.html" />
    <link rel="up" title="Adaptive Filters" href="../filters.html" />
    <link rel="next" title="Normalized Least-mean-squares (NLMS)" href="nlms.html" />
    <link rel="prev" title="Least-mean-squares (LMS)" href="lms.html" />
    <meta name="description" content="Padasip - Python Adaptive Signal Processing">
    <meta name="keywords" content="Adaptive,Signal,Processing,Filters,Neural Networks,">
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-73796119-2', 'auto');
      ga('send', 'pageview');
    </script>

  </head>
  <body role="document">
<div class="support_bar">
    <center>
        Do you want to support our effort? <a href="../support.html">Send us a postcard!</a>
    </center>
</div>


  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-padasip.filters.nlmf">
<span id="normalized-least-mean-fourth-nlmf"></span><span id="filter-nlmf"></span><h1>Normalized Least-mean-fourth (NLMF)<a class="headerlink" href="#module-padasip.filters.nlmf" title="Permalink to this headline">¶</a></h1>
<div class="versionadded">
<p><span class="versionmodified">New in version 1.1.0.</span></p>
</div>
<p>The least-mean-fourth (LMF) adaptive filter implemented according to the
paper <a class="reference internal" href="#zerguine2000convergence" id="id1">[1]</a>. The NLMF is an extension of the LMF
adaptive filter (<a class="reference internal" href="lmf.html#filter-lmf"><span class="std std-ref">Least-mean-fourth (LMF)</span></a>).</p>
<p>The NLMF filter can be created as follows</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">padasip</span> <span class="k">as</span> <span class="nn">pa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pa</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">FilterNLMF</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
<p>where <cite>n</cite> is the size (number of taps) of the filter.</p>
<p>Content of this page:</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#algorithm-explanation" id="id2">Algorithm Explanation</a></li>
<li><a class="reference internal" href="#minimal-working-examples" id="id3">Minimal Working Examples</a></li>
<li><a class="reference internal" href="#references" id="id4">References</a></li>
<li><a class="reference internal" href="#code-explanation" id="id5">Code Explanation</a></li>
</ul>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../filters.html#filters"><span class="std std-ref">Adaptive Filters</span></a></p>
</div>
<div class="section" id="algorithm-explanation">
<h2><a class="toc-backref" href="#id2">Algorithm Explanation</a><a class="headerlink" href="#algorithm-explanation" title="Permalink to this headline">¶</a></h2>
<p>The NLMF is extension of LMF filter. See <a class="reference internal" href="lmf.html#filter-lmf"><span class="std std-ref">Least-mean-fourth (LMF)</span></a>
for explanation of the algorithm behind.</p>
<p>The extension is based on normalization of learning rate.
The learning rage <span class="math">\(\mu\)</span> is replaced by learning rate <span class="math">\(\eta(k)\)</span>
normalized with every new sample according to input power as follows</p>
<p><span class="math">\(\eta (k) = \frac{\mu}{\epsilon + || \textbf{x}(k) ||^2}\)</span>,</p>
<p>where <span class="math">\(|| \textbf{x}(k) ||^2\)</span> is norm of input vector and 
<span class="math">\(\epsilon\)</span> is a small positive constant (regularization term).
This constant is introduced to preserve the stability in cases where
the input is close to zero.</p>
</div>
<div class="section" id="minimal-working-examples">
<h2><a class="toc-backref" href="#id3">Minimal Working Examples</a><a class="headerlink" href="#minimal-working-examples" title="Permalink to this headline">¶</a></h2>
<p>If you have measured data you may filter it as follows</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">padasip</span> <span class="kn">as</span> <span class="nn">pa</span> 

<span class="c1"># creation of data</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span> <span class="c1"># input matrix</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="c1"># noise</span>
<span class="n">d</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">x</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.3</span><span class="o">*</span><span class="n">x</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">x</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">v</span> <span class="c1"># target</span>

<span class="c1"># identification</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">FilterNLMF</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="s2">&quot;random&quot;</span><span class="p">)</span>
<span class="n">y</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

<span class="c1"># show results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Adaptation&quot;</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;samples - k&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;d - target&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;y - output&quot;</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Filter error&quot;</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;samples - k&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">e</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;e - error [dB]&quot;</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="references">
<h2><a class="toc-backref" href="#id4">References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p id="bibtex-bibliography-sources/filters/nlmf-0"><table class="docutils citation" frame="void" id="zerguine2000convergence" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>Azzedine Zerguine. Convergence behavior of the normalized least mean fourth algorithm. In <em>Signals, Systems and Computers, 2000. Conference Record of the Thirty-Fourth Asilomar Conference on</em>, volume 1, 275–278. IEEE, 2000.</td></tr>
</tbody>
</table>
</p>
</div>
<div class="section" id="code-explanation">
<h2><a class="toc-backref" href="#id5">Code Explanation</a><a class="headerlink" href="#code-explanation" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="padasip.filters.nlmf.FilterNLMF">
<em class="property">class </em><code class="descclassname">padasip.filters.nlmf.</code><code class="descname">FilterNLMF</code><span class="sig-paren">(</span><em>n</em>, <em>mu=0.1</em>, <em>eps=1.0</em>, <em>w='random'</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/padasip/filters/nlmf.html#FilterNLMF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#padasip.filters.nlmf.FilterNLMF" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">padasip.filters.base_filter.AdaptiveFilter</span></code></p>
<p>Adaptive NLMF filter.</p>
<p><strong>Args:</strong></p>
<ul class="simple">
<li><cite>n</cite> : length of filter (integer) - how many input is input array
(row of input matrix)</li>
</ul>
<p><strong>Kwargs:</strong></p>
<ul>
<li><p class="first"><cite>mu</cite> : learning rate (float). Also known as step size.
If it is too slow,
the filter may have bad performance. If it is too high,
the filter will be unstable. The default value can be unstable
for ill-conditioned input data.</p>
</li>
<li><p class="first"><cite>eps</cite> : regularization term (float). It is introduced to preserve
stability for close-to-zero input vectors</p>
</li>
<li><p class="first"><cite>w</cite> : initial weights of filter. Possible values are:</p>
<blockquote>
<div><ul class="simple">
<li>array with initial weights (1 dimensional array) of filter size</li>
<li>&#8220;random&#8221; : create random weights</li>
<li>&#8220;zeros&#8221; : create zero value weights</li>
</ul>
</div></blockquote>
</li>
</ul>
<dl class="method">
<dt id="padasip.filters.nlmf.FilterNLMF.adapt">
<code class="descname">adapt</code><span class="sig-paren">(</span><em>d</em>, <em>x</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/padasip/filters/nlmf.html#FilterNLMF.adapt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#padasip.filters.nlmf.FilterNLMF.adapt" title="Permalink to this definition">¶</a></dt>
<dd><p>Adapt weights according one desired value and its input.</p>
<p><strong>Args:</strong></p>
<ul class="simple">
<li><cite>d</cite> : desired value (float)</li>
<li><cite>x</cite> : input array (1-dimensional array)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="padasip.filters.nlmf.FilterNLMF.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>d</em>, <em>x</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/padasip/filters/nlmf.html#FilterNLMF.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#padasip.filters.nlmf.FilterNLMF.run" title="Permalink to this definition">¶</a></dt>
<dd><p>This function filters multiple samples in a row.</p>
<p><strong>Args:</strong></p>
<ul class="simple">
<li><cite>d</cite> : desired value (1 dimensional array)</li>
<li><cite>x</cite> : input matrix (2-dimensional array). Rows are samples,
columns are input arrays.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul class="simple">
<li><cite>y</cite> : output value (1 dimensional array).
The size corresponds with the desired value.</li>
<li><cite>e</cite> : filter error for every sample (1 dimensional array).
The size corresponds with the desired value.</li>
<li><cite>w</cite> : history of all weights (2 dimensional array).
Every row is set of the weights for given sample.</li>
</ul>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">

<a href="https://github.com/matousc89/padasip"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"></a>

<iframe src="https://ghbtns.com/github-btn.html?user=matousc89&repo=padasip&type=watch&count=true&size=large&v=2" frameborder="0" scrolling="0" width="160px" height="30px" style="margin-bottom: 5px;"></iframe>

<iframe src="https://ghbtns.com/github-btn.html?user=matousc89&repo=padasip&type=star&count=true&size=large" frameborder="0" scrolling="0" width="160px" height="30px" style="margin-bottom: 15px;"></iframe>

<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Padasip</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../index.html#license">License</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#instalation">Instalation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#tutorials">Tutorials</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html#the-user-quide">The User Quide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#contact">Contact</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#changelog">Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../preprocess.html">Data Preprocessing</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../filters.html">Adaptive Filters</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ap.html">Affine Projection (AP)</a></li>
<li class="toctree-l2"><a class="reference internal" href="gngd.html">Generalized Normalized Gradient Descent (GNGD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="lmf.html">Least-mean-fourth (LMF)</a></li>
<li class="toctree-l2"><a class="reference internal" href="lms.html">Least-mean-squares (LMS)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Normalized Least-mean-fourth (NLMF)</a></li>
<li class="toctree-l2"><a class="reference internal" href="nlms.html">Normalized Least-mean-squares (NLMS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="nsslms.html">Normalized Sign-sign Least-mean-squares (NSSLMS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="rls.html">Recursive Least Squares (RLS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="sslms.html">Sign-sign Least-mean-squares (SSLMS)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ann.html">Artificial Neural Networks (ANN)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../detection.html">Detection Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc.html">Miscellaneous</a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../filters.html">Adaptive Filters</a><ul>
      <li>Previous: <a href="lms.html" title="previous chapter">Least-mean-squares (LMS)</a></li>
      <li>Next: <a href="nlms.html" title="next chapter">Normalized Least-mean-squares (NLMS)</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Matous C.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
      |
      <a href="../../_sources/sources/filters/nlmf.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>